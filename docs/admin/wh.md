# 服务器运维指南

## 一、警告

!!! danger "重要警告"
    -   **切勿**升级服务器核心版本。

## 二、端口说明
服务器运行需要使用以下端口，请确保防火墙和网络设置已放行：
-   `5000`
-   `6099`
-   `26550`
-   `26551`
-   `26555` - `26558` (端口范围)

## 三、Java 环境
-   当前JDK版本：**JDK 21**

## 四、操作指令

### 1. 重启与关机
-   **关机**：使用 `stop` 命令。
    -   注意：根据现有设置，关机后服务可能会**自动重启**。
-   **强制重启**：当看门狗程序 (`watchdog`) 检测到死锁且无法自动恢复时，需要此操作。

### 2. 插件管理
-   **重载插件配置**：
    ```bash
    /[插件缩写] reload
    # 或者使用plugman
    /plugman reload [插件名]
    ```
-   **禁用插件**：
    ```bash
    /plugman disable [插件名]
    ```
-   **彻底禁用插件（手动）**：将插件文件后缀名改为 `.dis` (例如 `SomePlugin.jar` -> `SomePlugin.jar.dis`)

## 五、定时任务建议

### 1. 地图渲染
-   **任务**：为主世界 (`overworld`) 生成半径 `10000` 的地图预览。
-   **命令**：`map radiusrender overworld 10000`
-   **建议执行频率**：**每周五 00:00** 自动执行一次。

### 2. 服务器维护
-   **内容**：执行清理、存档备份或其他维护任务。
-   **建议执行时间**：**工作日（周一至周五）每天早上 06:00**。
-   **原则**：避免频繁重启服务器，仅在必要时进行。

## 六、日志分析与故障排除

### 1. 常规分析
-   查看日志文件的**最后部分**，寻找最初的错误线索。
-   若错误日志中出现 `Thread` 死锁或无法解决的异常，通常需要**强制重启**。

### 2. 插件问题
-   如果错误信息中包含**特定插件名**，解决方案如下：
    1.  尝试**更新**该插件到最新版本。
    2.  或者**重命名** 添加(`disable` 或 `.dis` 后缀) 

### 3. 已知异常处理
-   **问题**：服务器内部异常 就是`easybot` 抽风。
-   **解决步骤**：
    1. 前往 `napcat` 控制面板检查 **适配器是否在线**。


